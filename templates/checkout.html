{% extends "base.html" %}

{% block title %}Checkout{% endblock title %}

{% block body %}
<div class="container mt-5">
    <h1 class="mb-4">Checkout</h1>
    <div class="row">
        <!-- Order Summary -->
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Order Summary</h5>
                    <ul class="list-group list-group-flush">
                        {% for item in cart_items %}
                        <li class="list-group-item">
                            {{ item.product.name }} - Rs. {{ item.product.price }} (Quantity: {{ item.quantity }})
                        </li>
                        {% endfor %}
                    </ul>
                    <div class="mt-3">
                        <p><strong>Subtotal:</strong> Rs. {{ total_price }}</p>
                        <p><strong>Shipping:</strong> Rs. 0.00</p>
                        <p><strong>Total:</strong> Rs. {{ total_price }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment and Shipping Details -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Payment and Shipping Details</h5>
                    {% comment %} <form action="{% url 'process_checkout' %}" method="post"> {% endcomment %}
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="name" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email Address</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="address" class="form-label">Shipping Address</label>
                            <textarea class="form-control" id="address" name="address" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="payment_method" class="form-label">Payment Method</label>
                            <select class="form-select" id="payment_method" name="payment_method" required>
                                <option value="Credit Card">Credit Card</option>
                                <option value="Pay on Delivery">Pay on Delivery</option>
                            </select>
                        </div>
                        <div id="credit-card-details">
                            <div class="mb-3">
                                <label for="card_number" class="form-label">Card Number</label>
                                <input type="text" class="form-control" id="card_number" name="card_number">
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="expiry_date" class="form-label">Expiry Date</label>
                                    <input type="text" class="form-control" id="expiry_date" name="expiry_date" placeholder="MM/YY">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="cvv" class="form-label">CVV</label>
                                    <input type="text" class="form-control" id="cvv" name="cvv">
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-success w-100">Place Order</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Show/hide credit card details based on payment method
    document.getElementById('payment_method').addEventListener('change', function() {
        const creditCardDetails = document.getElementById('credit-card-details');
        if (this.value === 'Credit Card') {
            creditCardDetails.style.display = 'block';
        } else {
            creditCardDetails.style.display = 'none';
        }
    });

    // Hide credit card details initially if "Pay on Delivery" is selected
    document.addEventListener('DOMContentLoaded', function() {
        const paymentMethod = document.getElementById('payment_method');
        const creditCardDetails = document.getElementById('credit-card-details');
        if (paymentMethod.value !== 'Credit Card') {
            creditCardDetails.style.display = 'none';
        }
    });
</script>

{% endblock body %}
